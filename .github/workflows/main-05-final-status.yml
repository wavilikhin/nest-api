name: Final status

on:
    workflow_dispatch:
        inputs:
            force_failure:
                description: 'A backdoor trigger to force the final status to failed.'
                required: true
                default: false
    repository_dispatch:
        types: [main-05-final-check]
    push:
    pull_request:
        branches: ['master', 'development']

jobs:
    R-CMD-check:
        runs-on: ubuntu-latest

        steps:
            - name: Convey final status of all check workflows
              if: ${{ (github.event_name != 'workflow_dispatch' && !github.event.client_payload.success) || (github.event_name == 'workflow_dispatch' && github.event.inputs.force_failure) }}
              run: exit 1
